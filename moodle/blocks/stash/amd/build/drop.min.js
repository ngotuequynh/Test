/**
 * Drop module.
 *
 * @copyright  2016 Frédéric Massart - FMCorz.net
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_stash/drop",["jquery","core/ajax","core/log","block_stash/base","block_stash/item","block_stash/user-item","core/pubsub"],(function($,Ajax,Log,Base,Item,UserItem,PubSub){function Drop(dropdata,item){Base.prototype.constructor.apply(this,[dropdata]),this._item=item}return Drop.prototype=Object.create(Base.prototype),Drop.prototype.EVENT_PICKEDUP="drop:pickedup",Drop.prototype.getItem=function(){return this._item},Drop.prototype.isVisible=function(){return Ajax.call([{methodname:"block_stash_is_drop_visible",args:{dropid:this.get("id"),hashcode:this.get("hashcode")}}])[0].then((function(visible){return!!visible||$.Deferred().reject()}))},Drop.prototype.pickup=function(){return Ajax.call([{methodname:"block_stash_pickup_drop",args:{dropid:this.get("id"),hashcode:this.get("hashcode")}}])[0].fail((function(){Log.debug("The item could not be picked up.")})).then(function(data){var userItem=new UserItem(data.useritem,new Item(data.item));PubSub.publish("block_stash/drop/pickedup",{id:this.get("id"),hashcode:this.get("hashcode"),useritem:userItem})}.bind(this))},Drop}));

//# sourceMappingURL=drop.min.js.map